public class ATS_candidate_newOffer {
    
	@AuraEnabled
    public static String getApplicationData(String appId, String sObjectName,  String fieldSetName) {       
             
        String result = '';
        String fieldSet = ATS_candidate_newOffer.getApplicationFieldSet(sObjectName, fieldSetName);
        for(Application_V2__c app:[SELECT id, Applicant__r.Name, Job__r.Name FROM Application_V2__c WHERE id=:appId]){
            result += '"id":"' + app.id+ '",';
            result += '"applicantName":"' + app.Applicant__r.Name+ '",';
            result += '"jobName":"' + app.Job__r.Name+ '",';
            result += '"fieldSet":'+fieldSet;
        }
        
        return '{'+result+'}';
    }
    
   @AuraEnabled
    public static String getApplicationFieldSet(String sObjectName,  String fieldSetName) {
        String nameSpacePrefix = LightningUtility.getNamespaceName(); 
        
        fieldSetName = nameSpacePrefix+fieldSetName;
        sObjectName =  nameSpacePrefix+sObjectName;
        
        String result = ''; 
        try{
            SObjectType objToken = Schema.getGlobalDescribe().get(sObjectName);
            Schema.DescribeSObjectResult d = objToken.getDescribe();
            Map<String, Schema.FieldSet> FsMap = d.fieldSets.getMap();
            if(FsMap.containsKey(fieldSetName))
                for(Schema.FieldSetMember f : FsMap.get(fieldSetName).getFields()) {
                    if(result != ''){
                        result += ',';
                    }
                    String jsonPart = '{';
                    jsonPart += '"label":"' + f.getLabel() + '",';
                    jsonPart += '"required":"' + (f.getDBRequired() || f.getRequired()) + '",';
                    jsonPart += '"type":"' + (f.getType()) + '",';
                    jsonPart += '"name":"' + f.getFieldPath() + '",';
                    jsonPart += '"dev_name":"' + f.getFieldPath().removeStart(nameSpacePrefix) + '",';
                    jsonPart += '"value":""';
                    jsonPart += '}';
                    result += jsonPart;
                }
        }
        catch(Exception e){
            result += e.getLineNumber() + ' : ' + e.getMessage();
            return null;
        }
        system.debug('************** result == '+result);
        return result;
    }
    
}